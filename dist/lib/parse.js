import*as o from"fs";import{dirname as c}from"path";import h from"./../options/lib/callbacks.js";import d from"./files.js";var F=async(m,l,n=2,u="",w,t=()=>h)=>{let r={files:0,type:u,info:{}};for(const f of(await new d().in(m).by(l)).not(w).results){const e=f[1],i=f[0];try{const s=(await o.promises.stat(e)).size,a=await t().write(await t().read(e));if(!a)continue;if(await t().check(s,a)){try{await o.promises.access(c(i),o.constants.W_OK)}catch{await o.promises.mkdir(c(i),{recursive:!0})}await o.promises.writeFile(i,a,"utf-8");const p=(await o.promises.stat(i)).size;r.files++,r.info=t().pipe(e,i,s,p),n>1&&console.info(await t().success(e,i,s,p))}}catch{console.log(t().error(e))}}n>0&&console.info(await t().end(r))};export{F as default};
